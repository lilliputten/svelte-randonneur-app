import{s as $e,p as Pe,a as C,f as w,U as je,d as v,c as z,g as P,h as T,V as me,j as _,i as Q,K as g,I as ye,D as ie,o as Ie,l as ce,m as de,N as Se,P as Ne,n as ke}from"../chunks/scheduler.jafUb2iH.js";import{S as be,i as Le,f as Te,b as O,d as R,m as W,a as x,t as G,e as K}from"../chunks/index.VIoRrsQt.js";import{w as ge}from"../chunks/index.iWIm743a.js";import{g as te,r as Ue,e as Ve,a as Ce,b as ze}from"../chunks/navigation.0U_Aiylz.js";import{p as le,T as Be,q as _e,l as he,c as Me,L as Ae}from"../chunks/params.AZAjyG-P.js";import{R as Oe,a as Re,b as We}from"../chunks/RandoLogo.f3HctlUH.js";import{s as xe,h as Ge,a as ve,b as se}from"../chunks/randoFileInfoStore.FdoIm7nv.js";import{N as Ke,P as Je}from"../chunks/extendDataSetWithFilters.N31T2Y2S.js";function Fe(a){if(a){a.includes("NaN")&&(a=a.replace(/(:\s*)NaN($|,)/g,"$1null$2"));try{return JSON.parse(a)}catch(t){const o=["Failed to parse json data",te(t)].filter(Boolean).join(": "),r=new Error(o);console.error("[loadDemoData:safeParseJson]: error",o,{reason:o,error:t,jsonText:a});debugger;throw r}}}function De(a){Ue.set(a);const t=!!a;Ve(),Ce(),xe(t)}const qe="/data/",fe=[{id:"minimal-1",filename:"minimal-1.json"},{id:"agribalyse-3.1.1-biosphere-ecoinvent-3.8-biosphere",filename:"agribalyse-3.1.1-biosphere-ecoinvent-3.8-biosphere.json"},{id:"ecoinvent-biosphere-3.8-3.9-example",filename:"ecoinvent-biosphere-3.8-3.9-example.json"},{id:"simapro-selection-to-ecoinvent-3.9-biosphere",filename:"simapro-selection-to-ecoinvent-3.9-biosphere.json"},{id:"UVEK-2022-to-ecoinvent-3.9-partial-mining",filename:"UVEK-2022-to-ecoinvent-3.9-partial-mining.json"},{id:"UVEK-2022-to-ecoinvent-3.9-partial-transport",filename:"UVEK-2022-to-ecoinvent-3.9-partial-transport.json"}],He=0;function Ee(a){return fe[a].filename}function Qe(a){const t=Ee(a);return qe+t}function Xe(a){return fe[a].id}function Ye(a){const t=Qe(a);return fetch(t).then(e=>{const{ok:o,status:r,statusText:D}=e;if(!o){const u=[D,r&&"status: "+r].filter(Boolean).join(", ")||"Unknown error",s=new Error("Data loading error: "+u);console.error("[loadDemoData:loadDemoDataByIdx]: error (on then)",{reason:u,res:e,dataUrl:t});debugger;throw s}return e.text()}).then(e=>{const o=e&&Fe(e);if(!o)throw"Received empty data";const r=e.length;return{data:o,size:r}})}function Ze(a,t={}){const{name:e,size:o}=a,{onProgress:r,onLoaded:D,onError:u,timeout:s}=t;return new Promise(function(U,p){const m=new FileReader;let S=s?setTimeout(function(){m.abort();const y="Timeout of "+s+'ms exceeded during upload of file "'+e+'"',L=new Error(y);console.error("[loadDataFile] timeout error",{timeoutError:L,timeout:s,fileName:e,fileReader:m});debugger;return u&&u({error:L,fileReader:m}),p(L)},s):void 0;function b(){S&&(clearTimeout(S),S=void 0)}r&&(m.onprogress=function(y){const{lengthComputable:L,loaded:d,total:f}=y,h=L&&f?Math.round(d*100/f):void 0;r({progress:h,loaded:d,total:f,fileReader:m})}),m.onloadend=function(y){const{target:L}=y;try{const d=L?.result,f=d&&Fe(d);if(!f)throw"Received empty data";return D&&D({data:f,fileReader:m}),U({data:f,size:o})}catch(d){const f=['Data processing error for file "'+e+'"',te(d)].filter(Boolean).join(": "),h=new Error(f);console.error("[loadDataFile] onloadend: get data error",{dataError:h,error:d});debugger;return u&&u({error:h,fileReader:m}),p(h)}finally{b()}},m.onerror=function(y){const{loaded:L,target:d,type:f}=y;console.error("[loadDataFile] onerror",{fileName:e,loaded:L,target:d,errorType:f,ev:y});let h;if(d){const F=d.error,l=['Data loading error for file "'+e+'"',te(F)].filter(Boolean).join(": ");h=new Error(l)}else{const F='Unknown data loading error for file "'+e+'"';h=new Error(F)}console.error("[loadDataFile] onerror: event error",{resultError:h});debugger;return u&&u({error:h,fileReader:m}),b(),p(h)},m.readAsText(a)})}const et="_LoadDataPage_1vje0_11",tt="_WaiterPanel_1vje0_22",at="_inited_1vje0_37",ot="_goingOut_1vje0_37",rt="_loading_1vje0_37",nt="_Wrapper_1vje0_45",st="_SplashSection_1vje0_53",lt="_SplashBackground_1vje0_67",it="_dark_1vje0_78",ct="_SplashContent_1vje0_81",dt="_AppTitle_1vje0_90",ft="_LoadSection_1vje0_93",ut="_vpadded_1vje0_113",pt="_SectionLabel_1vje0_117",mt="_formGroup_1vje0_122",gt="_FileUploadField_1vje0_130",c={LoadDataPage:et,WaiterPanel:tt,inited:at,goingOut:ot,loading:rt,Wrapper:nt,SplashSection:st,SplashBackground:lt,dark:it,SplashContent:ct,AppTitle:dt,LoadSection:ft,vpadded:ut,SectionLabel:pt,formGroup:mt,FileUploadField:gt};function _t(a){let t;return{c(){t=ce(le)},l(e){t=de(e,le)},m(e,o){Q(e,t,o)},p:Se,d(e){e&&v(t)}}}function ht(a){let t,e,o,r,D,u;return{c(){t=w("span"),e=ce(a[1]),o=C(),r=w("input"),this.h()},l(s){t=P(s,"SPAN",{});var i=T(t);e=de(i,a[1]),i.forEach(v),o=z(s),r=P(s,"INPUT",{type:!0,id:!0,name:!0,accept:!0}),this.h()},h(){_(r,"type","file"),_(r,"id","localDataFile"),_(r,"name","localDataFile"),_(r,"accept","application/json")},m(s,i){Q(s,t,i),g(t,e),Q(s,o,i),Q(s,r,i),D||(u=Ne(r,"change",a[7]),D=!0)},p(s,i){i&2&&ke(e,s[1])},d(s){s&&(v(t),v(o),v(r)),D=!1,u()}}}function vt(a){let t;return{c(){t=ce("Load demo data")},l(e){t=de(e,"Load demo data")},m(e,o){Q(e,t,o)},d(e){e&&v(t)}}}function Dt(a){let t,e;return t=new Ae({}),{c(){O(t.$$.fragment)},l(o){R(t.$$.fragment,o)},m(o,r){W(t,o,r),e=!0},i(o){e||(x(t.$$.fragment,o),e=!0)},o(o){G(t.$$.fragment,o),e=!1},d(o){K(t,o)}}}function $t(a){let t,e,o,r,D,u,s,i,U,p,m,S,b,j,y="Load local data",L,d,f,h,F,l,V="Load demo data",N,$,I,X,Y,k,J,M,ae,Z;document.title="Start â€” "+le,i=new Oe({props:{size:50}}),p=new Be({props:{class:c.AppTitle,color:"blue",size:"xl",$$slots:{default:[_t]},$$scope:{ctx:a}}}),f=new _e({props:{class:c.FileUploadField,id:"localDataFile",name:"localDataFile",title:a[1],$$slots:{default:[ht]},$$scope:{ctx:a}}});function we(n){a[13](n)}let ue={data:a[5],id:"demoDataFile",placeholder:"Select demo dataset"};return a[0]!==void 0&&(ue.value=a[0]),I=new Ke({props:ue}),Pe.push(()=>Te(I,"value",we)),k=new _e({props:{id:"loadDemoDataAction",$$slots:{default:[vt]},$$scope:{ctx:a}}}),k.$on("click",a[6]),M=new Je({props:{class:c.WaiterPanel,radius:0,shadow:void 0,$$slots:{default:[Dt]},$$scope:{ctx:a}}}),{c(){t=C(),e=w("div"),o=w("div"),r=w("div"),D=w("div"),u=C(),s=w("div"),O(i.$$.fragment),U=C(),O(p.$$.fragment),m=C(),S=w("div"),b=w("section"),j=w("div"),j.textContent=y,L=C(),d=w("div"),O(f.$$.fragment),h=C(),F=w("section"),l=w("div"),l.textContent=V,N=C(),$=w("div"),O(I.$$.fragment),Y=C(),O(k.$$.fragment),J=C(),O(M.$$.fragment),this.h()},l(n){je("svelte-pa3tfe",document.head).forEach(v),t=z(n),e=P(n,"DIV",{class:!0});var ee=T(e);o=P(ee,"DIV",{class:!0});var A=T(o);r=P(A,"DIV",{class:!0});var q=T(r);D=P(q,"DIV",{class:!0}),T(D).forEach(v),u=z(q),s=P(q,"DIV",{class:!0,title:!0});var H=T(s);R(i.$$.fragment,H),U=z(H),R(p.$$.fragment,H),H.forEach(v),q.forEach(v),m=z(A),S=P(A,"DIV",{class:!0});var B=T(S);b=P(B,"SECTION",{id:!0,class:!0});var oe=T(b);j=P(oe,"DIV",{class:!0,"data-svelte-h":!0}),me(j)!=="svelte-18c8bhh"&&(j.textContent=y),L=z(oe),d=P(oe,"DIV",{class:!0});var pe=T(d);R(f.$$.fragment,pe),pe.forEach(v),oe.forEach(v),h=z(B),F=P(B,"SECTION",{id:!0,class:!0});var re=T(F);l=P(re,"DIV",{class:!0,"data-svelte-h":!0}),me(l)!=="svelte-ajwsgt"&&(l.textContent=V),N=z(re),$=P(re,"DIV",{class:!0});var ne=T($);R(I.$$.fragment,ne),Y=z(ne),R(k.$$.fragment,ne),ne.forEach(v),re.forEach(v),J=z(B),R(M.$$.fragment,B),B.forEach(v),A.forEach(v),ee.forEach(v),this.h()},h(){_(D,"class",c.SplashBackground),_(s,"class",c.SplashContent),_(s,"title",le),_(r,"class",c.SplashSection),_(j,"class",c.SectionLabel),_(d,"class",c.formGroup),_(b,"id","loadLocalData"),_(b,"class",c.delimited),_(l,"class",c.SectionLabel),_($,"class",c.formGroup),_(F,"id","loadDemoData"),_(F,"class",c.delimited),_(S,"class",c.LoadSection),_(o,"class",c.Wrapper),_(e,"class",ae=he(c.LoadDataPage,a[2]&&c.loading,a[9]&&c.goingOut&&a[4]&&c.inited,a[3]&&c.dark))},m(n,E){Q(n,t,E),Q(n,e,E),g(e,o),g(o,r),g(r,D),g(r,u),g(r,s),W(i,s,null),g(s,U),W(p,s,null),g(o,m),g(o,S),g(S,b),g(b,j),g(b,L),g(b,d),W(f,d,null),g(S,h),g(S,F),g(F,l),g(F,N),g(F,$),W(I,$,null),g($,Y),W(k,$,null),g(S,J),W(M,S,null),Z=!0},p(n,[E]){const ee={};E&262144&&(ee.$$scope={dirty:E,ctx:n}),p.$set(ee);const A={};E&2&&(A.title=n[1]),E&262146&&(A.$$scope={dirty:E,ctx:n}),f.$set(A);const q={};!X&&E&1&&(X=!0,q.value=n[0],ye(()=>X=!1)),I.$set(q);const H={};E&262144&&(H.$$scope={dirty:E,ctx:n}),k.$set(H);const B={};E&262144&&(B.$$scope={dirty:E,ctx:n}),M.$set(B),(!Z||E&28&&ae!==(ae=he(c.LoadDataPage,n[2]&&c.loading,n[9]&&c.goingOut&&n[4]&&c.inited,n[3]&&c.dark)))&&_(e,"class",ae)},i(n){Z||(x(i.$$.fragment,n),x(p.$$.fragment,n),x(f.$$.fragment,n),x(I.$$.fragment,n),x(k.$$.fragment,n),x(M.$$.fragment,n),Z=!0)},o(n){G(i.$$.fragment,n),G(p.$$.fragment,n),G(f.$$.fragment,n),G(I.$$.fragment,n),G(k.$$.fragment,n),G(M.$$.fragment,n),Z=!1},d(n){n&&(v(t),v(e)),K(i),K(p),K(f),K(I),K(k),K(M)}}}function St(a,t,e){let o,r,D,u,s;ie(a,Ge,l=>e(15,D=l)),ie(a,Me,l=>e(12,u=l));let i=He,U=!1,p,m=!1;const S=fe.map(({id:l},V)=>({label:l,value:String(V)}));let b="Select and upload local file";function j(){const l=Xe(i),V=Ee(i);e(10,U=!0),Ye(i).then(({data:N,size:$})=>{De(N),ve.set({name:V,type:"demo",size:$}),se({message:"Demo data loading successfully finished",type:"success"}),h()}).catch(N=>{const $=te(N);console.error("[LoadDataPage:loadDemoData] error",$,{error:N,dataId:l});debugger;se({message:$,type:"error"})}).finally(()=>{e(10,U=!1)})}function y(l){const N=l.target.files,$=N&&N[0];if(!$){const J=new Error("No file selected!");console.warn("[LoadDataPage:handleLocalFile] error",{error:J});return}const{name:I,type:X,size:Y}=$;if(!/\.json$/.test(I)||X!=="application/json"){const J=new Error("Expected json data file!");console.warn("[LoadDataPage:handleLocalFile] error",{error:J});return}p=$;const k=Re(Y,{normalize:!0}).join("");e(1,b=`${I} (${k})`),L()}function L(){if(!p){const l=new Error("No local file defined");console.warn("[LoadDataPage:loadLocalData] error",{error:l});debugger;return}e(11,m=!0),Ze(p,{timeout:5e3}).then(({data:l})=>{De(l),p&&ve.set({name:p.name,type:"uploaded",size:p.size}),se({message:"Local data loading successfully finished",type:"success"}),h()}).catch(l=>{const V=te(l);console.error("[LoadDataPage:loadLocalData] error",V,{error:l,localDataFile:p});debugger;se({message:V,type:"error"}),h()}).finally(()=>{e(11,m=!1)})}const d=ge(!1);ie(a,d,l=>e(4,s=l));let f=ge(!1);Ie(()=>{d.set(!0)});function h(){D&&(f.set(!0),ze(We))}function F(l){i=l,e(0,i)}return a.$$.update=()=>{a.$$.dirty&4096&&e(3,o=u==="dark"),a.$$.dirty&3072&&e(2,r=U||m)},[i,b,r,o,s,S,j,y,d,f,U,m,u,F]}class bt extends be{constructor(t){super(),Le(this,t,St,$t,$e,{})}}function Lt(a){let t,e;return t=new bt({}),{c(){O(t.$$.fragment)},l(o){R(t.$$.fragment,o)},m(o,r){W(t,o,r),e=!0},p:Se,i(o){e||(x(t.$$.fragment,o),e=!0)},o(o){G(t.$$.fragment,o),e=!1},d(o){K(t,o)}}}class kt extends be{constructor(t){super(),Le(this,t,null,Lt,$e,{})}}export{kt as component};
