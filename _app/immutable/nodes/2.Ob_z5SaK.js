import{V as ge,s as _e,p as Fe,a as k,f as E,W as Le,d as _,c as M,g as P,h as T,X as le,j as h,i as A,K as g,I as Ee,D as Pe,l as re,m as ne,S as we,n as Se,O as ye}from"../chunks/scheduler.rsKKbDYC.js";import{S as De,i as he,f as Ne,b as z,d as H,m as W,a as J,t as q,e as X}from"../chunks/index.DzfArh8w.js";import{r as $e,a as ue,e as Ie,B as oe,g as Ce}from"../chunks/navigation.I3VDyipM.js";import{l as S}from"../chunks/index.AOCYmvTY.js";import{s as Ue,h as me,a as K}from"../chunks/hasDataStore.ZuuwiclO.js";import{N as xe}from"../chunks/deriveDataSetSpec.Y-8kg9En.js";function ee(t){return t?t instanceof Error?t.message:String(t):""}function ke(t,a={}){const{fixedPoint:e=2,stripFixedZeros:o=!0}=a;let r=t.toFixed(e);return o&&(r=r.replace(/\.*0+$/,"")),r}function Me(t,a={}){const{normalize:e}=a,o=["B","K","M","G"],r=o.length-1,d=1024;let c=0,n=!1;for(;c<r;){const m=d-t;if(Math.abs(m)<100){n=!0,c++,t=1;break}else if(m>0)break;t/=d,c++}const f=o[c];let F=t;return e&&(F=ke(t,typeof e=="object"?e:void 0)),n&&(F="~"+F),[F,f]}function Te(){const t=ge($e);if(!t){ue.set(void 0);return}const{name:a,version:e,description:o,homepage:r,licenses:d,contributors:c,created:n}=t,f={name:a,version:e,description:o,homepage:r,licenses:d,contributors:c,created:n};ue.set(f)}function pe(t){$e.set(t);const a=!!t;Ie(),Te(),Ue(a)}function ve(t){if(t){t.includes("NaN")&&(t=t.replace(/(:\s*)NaN($|,)/g,"$1null$2"));try{return JSON.parse(t)}catch(a){const o=["Failed to parse json data",ee(a)].filter(Boolean).join(": "),r=new Error(o);console.error("[loadDemoData:safeParseJson]: error",o,{reason:o,error:a,jsonText:t});debugger;throw r}}}const je="/data/",ie=[{id:"minimal-1",filename:"minimal-1.json"},{id:"ecoinvent-biosphere-3.8-3.9-example",filename:"ecoinvent-biosphere-3.8-3.9-example.json"},{id:"simapro-selection-to-ecoinvent-3.9-biosphere",filename:"simapro-selection-to-ecoinvent-3.9-biosphere.json"},{id:"UVEK-2022-to-ecoinvent-3.9-partial-mining",filename:"UVEK-2022-to-ecoinvent-3.9-partial-mining.json"},{id:"UVEK-2022-to-ecoinvent-3.9-partial-transport",filename:"UVEK-2022-to-ecoinvent-3.9-partial-transport.json"}],Ve=0;function Be(t){const a=ie[t].filename;return je+a}function Ge(t){return ie[t].id}function Ae(t){const a=Be(t);return fetch(a).then(e=>{const{ok:o,status:r,statusText:d}=e;if(!o){const c=[d,r&&"status: "+r].filter(Boolean).join(", ")||"Unknown error",n=new Error("Data loading error: "+c);console.error("[loadDemoData:loadDemoDataByIdx]: error (on then)",{reason:c,res:e,dataUrl:a});debugger;throw n}return e.text()}).then(e=>{const o=e&&ve(e);if(!o)throw"Received empty data";return o})}function Oe(t,a={}){const{name:e}=t,{onProgress:o,onLoaded:r,onError:d,timeout:c}=a;return new Promise(function(f,F){const m=new FileReader;let $=c?setTimeout(function(){m.abort();const b="Timeout of "+c+'ms exceeded during upload of file "'+e+'"',p=new Error(b);console.error("[loadDataFile] timeout error",{timeoutError:p,timeout:c,fileName:e,fileReader:m});debugger;return d&&d({error:p,fileReader:m}),F(p)},c):void 0;function v(){$&&(clearTimeout($),$=void 0)}o&&(m.onprogress=function(b){const{lengthComputable:p,loaded:s,total:l}=b,u=p&&l?Math.round(s*100/l):void 0;o({progress:u,loaded:s,total:l,fileReader:m})}),m.onloadend=function(b){const{target:p}=b;try{const s=p?.result,l=s&&ve(s);if(!l)throw"Received empty data";return r&&r({data:l,fileReader:m}),f(l)}catch(s){const l=['Data processing error for file "'+e+'"',ee(s)].filter(Boolean).join(": "),u=new Error(l);console.error("[loadDataFile] onloadend: get data error",{dataError:u,error:s});debugger;return d&&d({error:u,fileReader:m}),F(u)}finally{v()}},m.onerror=function(b){const{loaded:p,target:s,type:l}=b;console.error("[loadDataFile] onerror",{fileName:e,loaded:p,target:s,errorType:l,ev:b});let u;if(s){const y=s.error,j=['Data loading error for file "'+e+'"',ee(y)].filter(Boolean).join(": ");u=new Error(j)}else{const y='Unknown data loading error for file "'+e+'"';u=new Error(y)}console.error("[loadDataFile] onerror: event error",{resultError:u});debugger;return d&&d({error:u,fileReader:m}),v(),F(u)},m.readAsText(t)})}const Re="_LoadDataPage_e399m_11",Ke="_LoadDataPage_Wrapper_e399m_21",ze="_loading_e399m_34",He="_vpadded_e399m_41",We="_delimited_e399m_45",Je="_formGroup_e399m_48",qe="_FileUploadField_e399m_54",C={LoadDataPage:Re,LoadDataPage_Wrapper:Ke,loading:ze,vpadded:He,delimited:We,formGroup:Je,FileUploadField:qe};function Xe(t){let a;return{c(){a=re("Load demo data")},l(e){a=ne(e,"Load demo data")},m(e,o){A(e,a,o)},d(e){e&&_(a)}}}function Ze(t){let a,e,o,r,d,c;return{c(){a=E("span"),e=re(t[2]),o=k(),r=E("input"),this.h()},l(n){a=P(n,"SPAN",{});var f=T(a);e=ne(f,t[2]),f.forEach(_),o=M(n),r=P(n,"INPUT",{type:!0,id:!0,name:!0,accept:!0}),this.h()},h(){h(r,"type","file"),h(r,"id","localDataFile"),h(r,"name","localDataFile"),h(r,"accept","application/json")},m(n,f){A(n,a,f),g(a,e),A(n,o,f),A(n,r,f),d||(c=we(r,"change",t[7]),d=!0)},p(n,f){f&4&&Se(e,n[2])},d(n){n&&(_(a),_(o),_(r)),d=!1,c()}}}function Qe(t){let a;return{c(){a=re("Load local data")},l(e){a=ne(e,"Load local data")},m(e,o){A(e,a,o)},d(e){e&&_(a)}}}function Ye(t){let a;return{c(){a=re("Go to editor")},l(e){a=ne(e,"Go to editor")},m(e,o){A(e,a,o)},d(e){e&&_(a)}}}function et(t){let a,e,o,r,d="Load data to edit",c,n,f,F="Load demo data",m,$,v,U,b,p,s,l,u,y="Load local data",j,N,I,Z,L,se,O,R,x,te,Q;function be(i){t[12](i)}let de={data:t[5],id:"demoDataFile",placeholder:"Pick one"};return t[0]!==void 0&&(de.value=t[0]),v=new xe({props:de}),Fe.push(()=>Ne(v,"value",be)),p=new oe({props:{id:"loadDemoDataAction",$$slots:{default:[Xe]},$$scope:{ctx:t}}}),p.$on("click",t[6]),I=new oe({props:{class:S(C.FileUploadField),id:"localDataFile",name:"localDataFile",title:t[2],$$slots:{default:[Ze]},$$scope:{ctx:t}}}),L=new oe({props:{id:"loadLocalDataAction",disabled:!t[1],$$slots:{default:[Qe]},$$scope:{ctx:t}}}),L.$on("click",t[8]),x=new oe({props:{id:"goToEditor",disabled:!t[4],$$slots:{default:[Ye]},$$scope:{ctx:t}}}),x.$on("click",t[9]),{c(){a=k(),e=E("div"),o=E("div"),r=E("h1"),r.textContent=d,c=k(),n=E("section"),f=E("h2"),f.textContent=F,m=k(),$=E("div"),z(v.$$.fragment),b=k(),z(p.$$.fragment),s=k(),l=E("section"),u=E("h2"),u.textContent=y,j=k(),N=E("div"),z(I.$$.fragment),Z=k(),z(L.$$.fragment),se=k(),O=E("section"),R=E("div"),z(x.$$.fragment),this.h()},l(i){Le("svelte-8l8mdx",document.head).forEach(_),a=M(i),e=P(i,"DIV",{class:!0});var Y=T(e);o=P(Y,"DIV",{class:!0});var w=T(o);r=P(w,"H1",{class:!0,"data-svelte-h":!0}),le(r)!=="svelte-1qoh4x6"&&(r.textContent=d),c=M(w),n=P(w,"SECTION",{id:!0,class:!0});var V=T(n);f=P(V,"H2",{"data-svelte-h":!0}),le(f)!=="svelte-133invn"&&(f.textContent=F),m=M(V),$=P(V,"DIV",{class:!0});var B=T($);H(v.$$.fragment,B),b=M(B),H(p.$$.fragment,B),B.forEach(_),V.forEach(_),s=M(w),l=P(w,"SECTION",{id:!0,class:!0});var G=T(l);u=P(G,"H2",{"data-svelte-h":!0}),le(u)!=="svelte-ua788t"&&(u.textContent=y),j=M(G),N=P(G,"DIV",{class:!0});var ae=T(N);H(I.$$.fragment,ae),Z=M(ae),H(L.$$.fragment,ae),ae.forEach(_),G.forEach(_),se=M(w),O=P(w,"SECTION",{id:!0,class:!0});var ce=T(O);R=P(ce,"DIV",{class:!0});var fe=T(R);H(x.$$.fragment,fe),fe.forEach(_),ce.forEach(_),w.forEach(_),Y.forEach(_),this.h()},h(){document.title="Load data",h(r,"class",S(C.header)),h($,"class",S(C.formGroup)),h(n,"id","loadDemoData"),h(n,"class",S(C.delimited)),h(N,"class",S(C.formGroup)),h(l,"id","loadLocalData"),h(l,"class",S(C.delimited)),h(R,"class",S(C.formGroup)),h(O,"id","actions"),h(O,"class",S("delimited","vpadded")),h(o,"class",S(C.LoadDataPage_Wrapper)),h(e,"class",te=S(C.LoadDataPage,t[3]&&"loading"))},m(i,D){A(i,a,D),A(i,e,D),g(e,o),g(o,r),g(o,c),g(o,n),g(n,f),g(n,m),g(n,$),W(v,$,null),g($,b),W(p,$,null),g(o,s),g(o,l),g(l,u),g(l,j),g(l,N),W(I,N,null),g(N,Z),W(L,N,null),g(o,se),g(o,O),g(O,R),W(x,R,null),Q=!0},p(i,[D]){const Y={};!U&&D&1&&(U=!0,Y.value=i[0],Ee(()=>U=!1)),v.$set(Y);const w={};D&8192&&(w.$$scope={dirty:D,ctx:i}),p.$set(w);const V={};D&4&&(V.title=i[2]),D&8196&&(V.$$scope={dirty:D,ctx:i}),I.$set(V);const B={};D&2&&(B.disabled=!i[1]),D&8192&&(B.$$scope={dirty:D,ctx:i}),L.$set(B);const G={};D&16&&(G.disabled=!i[4]),D&8192&&(G.$$scope={dirty:D,ctx:i}),x.$set(G),(!Q||D&8&&te!==(te=S(C.LoadDataPage,i[3]&&"loading")))&&h(e,"class",te)},i(i){Q||(J(v.$$.fragment,i),J(p.$$.fragment,i),J(I.$$.fragment,i),J(L.$$.fragment,i),J(x.$$.fragment,i),Q=!0)},o(i){q(v.$$.fragment,i),q(p.$$.fragment,i),q(I.$$.fragment,i),q(L.$$.fragment,i),q(x.$$.fragment,i),Q=!1},d(i){i&&(_(a),_(e)),X(v),X(p),X(I),X(L),X(x)}}}function tt(t,a,e){let o,r;Pe(t,me,s=>e(4,r=s));let d=Ve,c=!1,n,f=!1;const F=ie.map(({id:s},l)=>({label:s,value:String(l)}));let m="Upload file";function $(){const s=Ge(d);e(10,c=!0),K({message:"Demo data loading started",type:"info"}),Ae(d).then(l=>{pe(l),K({message:"Demo data loading successfully finished",type:"success"})}).catch(l=>{const u=ee(l);console.error("[LoadDataPage:loadDemoData] error",u,{error:l,dataId:s});debugger;K({message:u,type:"error"})}).finally(()=>{e(10,c=!1)})}function v(s){const u=s.target.files,y=u&&u[0];if(!y){const L=new Error("No file selected!");console.warn("[LoadDataPage:handleLocalFile] error",{error:L});return}const{name:j,type:N,size:I}=y;if(!/\.json$/.test(j)||N!=="application/json"){const L=new Error("Expected json data file!");console.warn("[LoadDataPage:handleLocalFile] error",{error:L});return}e(1,n=y);const Z=Me(I,{normalize:!0}).join("");e(2,m=`${j} (${Z})`)}function U(){if(!n){const s=new Error("No local file defined");console.warn("[LoadDataPage:loadLocalData] error",{error:s});debugger;return}K({message:"Local data loading started",type:"info"}),e(11,f=!0),Oe(n,{timeout:5e3}).then(s=>{pe(s),K({message:"Local data loading successfully finished",type:"success"})}).catch(s=>{const l=ee(s);console.error("[LoadDataPage:loadLocalData] error",l,{error:s,localDataFile:n});debugger;K({message:l,type:"error"})}).finally(()=>{e(11,f=!1)})}function b(){ge(me)&&Ce("/editor")}function p(s){d=s,e(0,d)}return t.$$.update=()=>{t.$$.dirty&3072&&e(3,o=c||f)},[d,n,m,o,r,F,$,v,U,b,c,f,p]}class at extends De{constructor(a){super(),he(this,a,tt,et,_e,{})}}function ot(t){let a,e;return a=new at({}),{c(){z(a.$$.fragment)},l(o){H(a.$$.fragment,o)},m(o,r){W(a,o,r),e=!0},p:ye,i(o){e||(J(a.$$.fragment,o),e=!0)},o(o){q(a.$$.fragment,o),e=!1},d(o){X(a,o)}}}class ct extends De{constructor(a){super(),he(this,a,null,ot,_e,{})}}export{ct as component};
