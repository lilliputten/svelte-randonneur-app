import{s as $e,p as Pe,a as U,f as w,V as je,d as D,c as z,g as P,h as V,W as pe,j as h,i as Q,K as g,I as ye,D as le,o as Ie,l as ie,m as ce,O as Se,S as Ne,n as ke}from"../chunks/scheduler.8lYd5bl9.js";import{S as be,i as Le,f as Te,b as A,d as R,m as W,a as x,t as G,e as K}from"../chunks/index.QJWWgKti.js";import{w as me}from"../chunks/index.xdyzVbPO.js";import{g as te,r as Ve,e as Ce,a as Ue,b as ze}from"../chunks/navigation.k4DELVeN.js";import{T as Be,l as ge,c as Me,L as Oe}from"../chunks/FilterActionIcon.module.ENRE_V7v.js";import{R as Ae,a as _e,g as Re}from"../chunks/RandoLogo.sWdHMzWE.js";import{s as We,h as xe,a as he,b as se}from"../chunks/randoFileInfoStore.3THqlZgm.js";import{B as De,N as Ge,P as Ke}from"../chunks/extendDataSetWithFilters.73Ta82tq.js";function Fe(a){if(a){a.includes("NaN")&&(a=a.replace(/(:\s*)NaN($|,)/g,"$1null$2"));try{return JSON.parse(a)}catch(t){const o=["Failed to parse json data",te(t)].filter(Boolean).join(": "),r=new Error(o);console.error("[loadDemoData:safeParseJson]: error",o,{reason:o,error:t,jsonText:a});debugger;throw r}}}function ve(a){Ve.set(a);const t=!!a;Ce(),Ue(),We(t)}const Je="/data/",de=[{id:"minimal-1",filename:"minimal-1.json"},{id:"agribalyse-3.1.1-biosphere-ecoinvent-3.8-biosphere",filename:"agribalyse-3.1.1-biosphere-ecoinvent-3.8-biosphere.json"},{id:"ecoinvent-biosphere-3.8-3.9-example",filename:"ecoinvent-biosphere-3.8-3.9-example.json"},{id:"simapro-selection-to-ecoinvent-3.9-biosphere",filename:"simapro-selection-to-ecoinvent-3.9-biosphere.json"},{id:"UVEK-2022-to-ecoinvent-3.9-partial-mining",filename:"UVEK-2022-to-ecoinvent-3.9-partial-mining.json"},{id:"UVEK-2022-to-ecoinvent-3.9-partial-transport",filename:"UVEK-2022-to-ecoinvent-3.9-partial-transport.json"}],He=0;function Ee(a){return de[a].filename}function qe(a){const t=Ee(a);return Je+t}function Qe(a){return de[a].id}function Xe(a){const t=qe(a);return fetch(t).then(e=>{const{ok:o,status:r,statusText:$}=e;if(!o){const p=[$,r&&"status: "+r].filter(Boolean).join(", ")||"Unknown error",l=new Error("Data loading error: "+p);console.error("[loadDemoData:loadDemoDataByIdx]: error (on then)",{reason:p,res:e,dataUrl:t});debugger;throw l}return e.text()}).then(e=>{const o=e&&Fe(e);if(!o)throw"Received empty data";const r=e.length;return{data:o,size:r}})}function Ye(a,t={}){const{name:e,size:o}=a,{onProgress:r,onLoaded:$,onError:p,timeout:l}=t;return new Promise(function(C,f){const m=new FileReader;let S=l?setTimeout(function(){m.abort();const y="Timeout of "+l+'ms exceeded during upload of file "'+e+'"',L=new Error(y);console.error("[loadDataFile] timeout error",{timeoutError:L,timeout:l,fileName:e,fileReader:m});debugger;return p&&p({error:L,fileReader:m}),f(L)},l):void 0;function b(){S&&(clearTimeout(S),S=void 0)}r&&(m.onprogress=function(y){const{lengthComputable:L,loaded:d,total:u}=y,_=L&&u?Math.round(d*100/u):void 0;r({progress:_,loaded:d,total:u,fileReader:m})}),m.onloadend=function(y){const{target:L}=y;try{const d=L?.result,u=d&&Fe(d);if(!u)throw"Received empty data";return $&&$({data:u,fileReader:m}),C({data:u,size:o})}catch(d){const u=['Data processing error for file "'+e+'"',te(d)].filter(Boolean).join(": "),_=new Error(u);console.error("[loadDataFile] onloadend: get data error",{dataError:_,error:d});debugger;return p&&p({error:_,fileReader:m}),f(_)}finally{b()}},m.onerror=function(y){const{loaded:L,target:d,type:u}=y;console.error("[loadDataFile] onerror",{fileName:e,loaded:L,target:d,errorType:u,ev:y});let _;if(d){const F=d.error,s=['Data loading error for file "'+e+'"',te(F)].filter(Boolean).join(": ");_=new Error(s)}else{const F='Unknown data loading error for file "'+e+'"';_=new Error(F)}console.error("[loadDataFile] onerror: event error",{resultError:_});debugger;return p&&p({error:_,fileReader:m}),b(),f(_)},m.readAsText(a)})}const Ze="_LoadDataPage_1vje0_11",et="_WaiterPanel_1vje0_22",tt="_inited_1vje0_37",at="_goingOut_1vje0_37",ot="_loading_1vje0_37",rt="_Wrapper_1vje0_45",nt="_SplashSection_1vje0_53",st="_SplashBackground_1vje0_67",lt="_dark_1vje0_78",it="_SplashContent_1vje0_81",ct="_AppTitle_1vje0_90",dt="_LoadSection_1vje0_93",ut="_vpadded_1vje0_113",ft="_SectionLabel_1vje0_117",pt="_formGroup_1vje0_122",mt="_FileUploadField_1vje0_130",c={LoadDataPage:Ze,WaiterPanel:et,inited:tt,goingOut:at,loading:ot,Wrapper:rt,SplashSection:nt,SplashBackground:st,dark:lt,SplashContent:it,AppTitle:ct,LoadSection:dt,vpadded:ut,SectionLabel:ft,formGroup:pt,FileUploadField:mt};function gt(a){let t;return{c(){t=ie(_e)},l(e){t=ce(e,_e)},m(e,o){Q(e,t,o)},p:Se,d(e){e&&D(t)}}}function _t(a){let t,e,o,r,$,p;return{c(){t=w("span"),e=ie(a[1]),o=U(),r=w("input"),this.h()},l(l){t=P(l,"SPAN",{});var i=V(t);e=ce(i,a[1]),i.forEach(D),o=z(l),r=P(l,"INPUT",{type:!0,id:!0,name:!0,accept:!0}),this.h()},h(){h(r,"type","file"),h(r,"id","localDataFile"),h(r,"name","localDataFile"),h(r,"accept","application/json")},m(l,i){Q(l,t,i),g(t,e),Q(l,o,i),Q(l,r,i),$||(p=Ne(r,"change",a[7]),$=!0)},p(l,i){i&2&&ke(e,l[1])},d(l){l&&(D(t),D(o),D(r)),$=!1,p()}}}function ht(a){let t;return{c(){t=ie("Load demo data")},l(e){t=ce(e,"Load demo data")},m(e,o){Q(e,t,o)},d(e){e&&D(t)}}}function Dt(a){let t,e;return t=new Oe({}),{c(){A(t.$$.fragment)},l(o){R(t.$$.fragment,o)},m(o,r){W(t,o,r),e=!0},i(o){e||(x(t.$$.fragment,o),e=!0)},o(o){G(t.$$.fragment,o),e=!1},d(o){K(t,o)}}}function vt(a){let t,e,o,r,$,p,l,i,C,f,m,S,b,j,y="Load local data",L,d,u,_,F,s,I="Load demo data",N,v,k,X,Y,T,J,M,ae,Z;i=new Ae({props:{size:50}}),f=new Be({props:{class:c.AppTitle,color:"blue",size:"xl",$$slots:{default:[gt]},$$scope:{ctx:a}}}),u=new De({props:{class:c.FileUploadField,id:"localDataFile",name:"localDataFile",title:a[1],$$slots:{default:[_t]},$$scope:{ctx:a}}});function we(n){a[13](n)}let ue={data:a[5],id:"demoDataFile",placeholder:"Select demo dataset"};return a[0]!==void 0&&(ue.value=a[0]),k=new Ge({props:ue}),Pe.push(()=>Te(k,"value",we)),T=new De({props:{id:"loadDemoDataAction",$$slots:{default:[ht]},$$scope:{ctx:a}}}),T.$on("click",a[6]),M=new Ke({props:{class:c.WaiterPanel,radius:0,shadow:void 0,$$slots:{default:[Dt]},$$scope:{ctx:a}}}),{c(){t=U(),e=w("div"),o=w("div"),r=w("div"),$=w("div"),p=U(),l=w("div"),A(i.$$.fragment),C=U(),A(f.$$.fragment),m=U(),S=w("div"),b=w("section"),j=w("div"),j.textContent=y,L=U(),d=w("div"),A(u.$$.fragment),_=U(),F=w("section"),s=w("div"),s.textContent=I,N=U(),v=w("div"),A(k.$$.fragment),Y=U(),A(T.$$.fragment),J=U(),A(M.$$.fragment),this.h()},l(n){je("svelte-8l8mdx",document.head).forEach(D),t=z(n),e=P(n,"DIV",{class:!0});var ee=V(e);o=P(ee,"DIV",{class:!0});var O=V(o);r=P(O,"DIV",{class:!0});var H=V(r);$=P(H,"DIV",{class:!0}),V($).forEach(D),p=z(H),l=P(H,"DIV",{class:!0});var q=V(l);R(i.$$.fragment,q),C=z(q),R(f.$$.fragment,q),q.forEach(D),H.forEach(D),m=z(O),S=P(O,"DIV",{class:!0});var B=V(S);b=P(B,"SECTION",{id:!0,class:!0});var oe=V(b);j=P(oe,"DIV",{class:!0,"data-svelte-h":!0}),pe(j)!=="svelte-18c8bhh"&&(j.textContent=y),L=z(oe),d=P(oe,"DIV",{class:!0});var fe=V(d);R(u.$$.fragment,fe),fe.forEach(D),oe.forEach(D),_=z(B),F=P(B,"SECTION",{id:!0,class:!0});var re=V(F);s=P(re,"DIV",{class:!0,"data-svelte-h":!0}),pe(s)!=="svelte-ajwsgt"&&(s.textContent=I),N=z(re),v=P(re,"DIV",{class:!0});var ne=V(v);R(k.$$.fragment,ne),Y=z(ne),R(T.$$.fragment,ne),ne.forEach(D),re.forEach(D),J=z(B),R(M.$$.fragment,B),B.forEach(D),O.forEach(D),ee.forEach(D),this.h()},h(){document.title="Load data",h($,"class",c.SplashBackground),h(l,"class",c.SplashContent),h(r,"class",c.SplashSection),h(j,"class",c.SectionLabel),h(d,"class",c.formGroup),h(b,"id","loadLocalData"),h(b,"class",c.delimited),h(s,"class",c.SectionLabel),h(v,"class",c.formGroup),h(F,"id","loadDemoData"),h(F,"class",c.delimited),h(S,"class",c.LoadSection),h(o,"class",c.Wrapper),h(e,"class",ae=ge(c.LoadDataPage,a[2]&&c.loading,a[9]&&c.goingOut&&a[4]&&c.inited,a[3]&&c.dark))},m(n,E){Q(n,t,E),Q(n,e,E),g(e,o),g(o,r),g(r,$),g(r,p),g(r,l),W(i,l,null),g(l,C),W(f,l,null),g(o,m),g(o,S),g(S,b),g(b,j),g(b,L),g(b,d),W(u,d,null),g(S,_),g(S,F),g(F,s),g(F,N),g(F,v),W(k,v,null),g(v,Y),W(T,v,null),g(S,J),W(M,S,null),Z=!0},p(n,[E]){const ee={};E&262144&&(ee.$$scope={dirty:E,ctx:n}),f.$set(ee);const O={};E&2&&(O.title=n[1]),E&262146&&(O.$$scope={dirty:E,ctx:n}),u.$set(O);const H={};!X&&E&1&&(X=!0,H.value=n[0],ye(()=>X=!1)),k.$set(H);const q={};E&262144&&(q.$$scope={dirty:E,ctx:n}),T.$set(q);const B={};E&262144&&(B.$$scope={dirty:E,ctx:n}),M.$set(B),(!Z||E&28&&ae!==(ae=ge(c.LoadDataPage,n[2]&&c.loading,n[9]&&c.goingOut&&n[4]&&c.inited,n[3]&&c.dark)))&&h(e,"class",ae)},i(n){Z||(x(i.$$.fragment,n),x(f.$$.fragment,n),x(u.$$.fragment,n),x(k.$$.fragment,n),x(T.$$.fragment,n),x(M.$$.fragment,n),Z=!0)},o(n){G(i.$$.fragment,n),G(f.$$.fragment,n),G(u.$$.fragment,n),G(k.$$.fragment,n),G(T.$$.fragment,n),G(M.$$.fragment,n),Z=!1},d(n){n&&(D(t),D(e)),K(i),K(f),K(u),K(k),K(T),K(M)}}}function $t(a,t,e){let o,r,$,p,l;le(a,xe,s=>e(15,$=s)),le(a,Me,s=>e(12,p=s));let i=He,C=!1,f,m=!1;const S=de.map(({id:s},I)=>({label:s,value:String(I)}));let b="Select and upload local file";function j(){const s=Qe(i),I=Ee(i);e(10,C=!0),Xe(i).then(({data:N,size:v})=>{console.log("[LoadDataPage:loadDemoData] success",{dataId:s,data:N,size:v}),ve(N),he.set({name:I,type:"demo",size:v}),se({message:"Demo data loading successfully finished",type:"success"}),_()}).catch(N=>{const v=te(N);console.error("[LoadDataPage:loadDemoData] error",v,{error:N,dataId:s});debugger;se({message:v,type:"error"})}).finally(()=>{e(10,C=!1)})}function y(s){const N=s.target.files,v=N&&N[0];if(!v){const J=new Error("No file selected!");console.warn("[LoadDataPage:handleLocalFile] error",{error:J});return}const{name:k,type:X,size:Y}=v;if(!/\.json$/.test(k)||X!=="application/json"){const J=new Error("Expected json data file!");console.warn("[LoadDataPage:handleLocalFile] error",{error:J});return}f=v;const T=Re(Y,{normalize:!0}).join("");e(1,b=`${k} (${T})`),L()}function L(){if(!f){const s=new Error("No local file defined");console.warn("[LoadDataPage:loadLocalData] error",{error:s});debugger;return}e(11,m=!0),Ye(f,{timeout:5e3}).then(({data:s,size:I})=>{console.log("[LoadDataPage:loadLocalData] success",{localDataFile:f,data:s,size:I}),ve(s),f&&he.set({name:f.name,type:"uploaded",size:f.size}),se({message:"Local data loading successfully finished",type:"success"}),_()}).catch(s=>{const I=te(s);console.error("[LoadDataPage:loadLocalData] error",I,{error:s,localDataFile:f});debugger;se({message:I,type:"error"}),_()}).finally(()=>{e(11,m=!1)})}const d=me(!1);le(a,d,s=>e(4,l=s));let u=me(!1);Ie(()=>{d.set(!0)});function _(){$&&(u.set(!0),ze("/data"))}function F(s){i=s,e(0,i)}return a.$$.update=()=>{a.$$.dirty&4096&&e(3,o=p==="dark"),a.$$.dirty&3072&&e(2,r=C||m)},[i,b,r,o,l,S,j,y,d,u,C,m,p,F]}class St extends be{constructor(t){super(),Le(this,t,$t,vt,$e,{})}}function bt(a){let t,e;return t=new St({}),{c(){A(t.$$.fragment)},l(o){R(t.$$.fragment,o)},m(o,r){W(t,o,r),e=!0},p:Se,i(o){e||(x(t.$$.fragment,o),e=!0)},o(o){G(t.$$.fragment,o),e=!1},d(o){K(t,o)}}}class Nt extends be{constructor(t){super(),Le(this,t,null,bt,$e,{})}}export{Nt as component};
